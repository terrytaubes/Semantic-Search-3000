In natural language processing, latent Dirichlet allocation (LDA) is a generative statistical model that allows sets of observations to be explained by unobserved groups that explain why some parts of the data are similar. For example, if observations are words collected into documents, it posits that each document is a mixture of a small number of topics and that each word's creation is attributable to one of the document's topics. LDA is an example of a topic model and was first presented as a graphical model for topic discovery by David Blei, Andrew Ng, and Michael I. Jordan in 2003. Essentially the same model was also proposed independently by J. K. Pritchard, M. Stephens, and P. Donnelly in the study of population genetics in 2000. Both papers have been highly influential, with 19858 and 20416 citations respectively by August 2017.


== Topics ==
In LDA, each document may be viewed as a mixture of various topics where each document is considered to have a set of topics that are assigned to it via LDA. This is identical to probabilistic latent semantic analysis (pLSA), except that in LDA the topic distribution is assumed to have a sparse Dirichlet prior. The sparse Dirichlet priors encode the intuition that documents cover only a small set of topics and that topics use only a small set of words frequently. In practice, this results in a better disambiguation of words and a more precise assignment of documents to topics. LDA is a generalisation of the pLSA model, which is equivalent to LDA under a uniform Dirichlet prior distribution.
For example, an LDA model might have topics that can be classified as CAT_related and DOG_related. A topic has probabilities of generating various words, such as milk, meow, and kitten, which can be classified and interpreted by the viewer as "CAT_related". Naturally, the word cat itself will have high probability given this topic. The DOG_related topic likewise has probabilities of generating each word: puppy, bark, and bone might have high probability. Words without special relevance, such as the (see function word), will have roughly even probability between classes (or can be placed into a separate category). A topic is not strongly defined, neither semantically nor epistemologically. It is identified on the basis of automatic detection of the likelihood of term co-occurrence. A lexical word may occur in several topics with a different probability, however, with a different typical set of neighboring words in each topic.
Each document is assumed to be characterized by a particular set of topics. This is akin to the standard bag of words model assumption, and makes the individual words exchangeable.


== Model ==

With plate notation, the dependencies among the many variables can be captured concisely. The boxes are “plates” representing replicates. The outer plate represents documents, while the inner plate represents the repeated choice of topics and words within a document. M denotes the number of documents, N the number of words in a document. Thus:
α is the parameter of the Dirichlet prior on the per-document topic distributions,
β is the parameter of the Dirichlet prior on the per-topic word distribution,

  
    
      
        
          θ
          
            m
          
        
      
    
    {\displaystyle \theta _{m}}
   is the topic distribution for document m,

  
    
      
        
          φ
          
            k
          
        
      
    
    {\displaystyle \varphi _{k}}
   is the word distribution for topic k,

  
    
      
        
          z
          
            m
            n
          
        
      
    
    {\displaystyle z_{mn}}
   is the topic for the n-th word in document m, and

  
    
      
        
          w
          
            m
            n
          
        
      
    
    {\displaystyle w_{mn}}
   is the specific word.

The words 
  
    
      
        
          w
          
            i
            j
          
        
      
    
    {\displaystyle w_{ij}}
   are the only observable variables, and the other variables are latent variables. As proposed in the original paper, a sparse Dirichlet prior can be put over the topic-word distribution. This codes the intuition that the probability of topics is focussed on a small set of words. The resulting model is the today most widely applied variant of LDA. The plate notation for this model is shown on the right, where 
  
    
      
        K
      
    
    {\displaystyle K}
   denotes the number of topics and 
  
    
      
        
          φ
          
            1
          
        
        ,
        …
        ,
        
          φ
          
            K
          
        
      
    
    {\displaystyle \varphi _{1},\dots ,\varphi _{K}}
   are 
  
    
      
        V
      
    
    {\displaystyle V}
  -dimensional vectors storing the parameters of the Dirichlet-distributed topic-word distributions (
  
    
      
        V
      
    
    {\displaystyle V}
   is the number of words in the vocabulary).


=== Generative process ===
The generative process is as follows. Documents are represented as random mixtures over latent topics, where each topic is characterized by a distribution over words. LDA assumes the following generative process for a corpus 
  
    
      
        D
      
    
    {\displaystyle D}
   consisting of 
  
    
      
        M
      
    
    {\displaystyle M}
   documents each of length 
  
    
      
        
          N
          
            i
          
        
      
    
    {\displaystyle N_{i}}
  :
1. Choose 
  
    
      
        
          θ
          
            i
          
        
        ∼
        Dir
        ⁡
        (
        α
        )
      
    
    {\displaystyle \theta _{i}\sim \operatorname {Dir} (\alpha )}
  , where 
  
    
      
        i
        ∈
        {
        1
        ,
        …
        ,
        M
        }
      
    
    {\displaystyle i\in \{1,\dots ,M\}}
   and 
  
    
      
        
          D
          i
          r
        
        (
        α
        )
      
    
    {\displaystyle \mathrm {Dir} (\alpha )}
   is a Dirichlet distribution with a symmetric parameter 
  
    
      
        α
      
    
    {\displaystyle \alpha }
   which typically is sparse (
  
    
      
        α
        <
        1
      
    
    {\displaystyle \alpha <1}
  )
2. Choose 
  
    
      
        
          φ
          
            k
          
        
        ∼
        Dir
        ⁡
        (
        β
        )
      
    
    {\displaystyle \varphi _{k}\sim \operatorname {Dir} (\beta )}
  , where 
  
    
      
        k
        ∈
        {
        1
        ,
        …
        ,
        K
        }
      
    
    {\displaystyle k\in \{1,\dots ,K\}}
   and 
  
    
      
        β
      
    
    {\displaystyle \beta }
   typically is sparse
3. For each of the word positions 
  
    
      
        i
        ,
        j
      
    
    {\displaystyle i,j}
  , where 
  
    
      
        j
        ∈
        {
        1
        ,
        …
        ,
        
          N
          
            i
          
        
        }
      
    
    {\displaystyle j\in \{1,\dots ,N_{i}\}}
  , and 
  
    
      
        i
        ∈
        {
        1
        ,
        …
        ,
        M
        }
      
    
    {\displaystyle i\in \{1,\dots ,M\}}
  
(a) Choose a topic 
  
    
      
        
          z
          
            i
            ,
            j
          
        
        ∼
        Multinomial
        ⁡
        (
        
          θ
          
            i
          
        
        )
        .
      
    
    {\displaystyle z_{i,j}\sim \operatorname {Multinomial} (\theta _{i}).}
  
(b) Choose a word 
  
    
      
        
          w
          
            i
            ,
            j
          
        
        ∼
        Multinomial
        ⁡
        (
        
          φ
          
            
              z
              
                i
                ,
                j
              
            
          
        
        )
        .
      
    
    {\displaystyle w_{i,j}\sim \operatorname {Multinomial} (\varphi _{z_{i,j}}).}
  
(Note that multinomial distribution here refers to the multinomial with only one trial, which is also known as the categorical distribution.)
The lengths 
  
    
      
        
          N
          
            i
          
        
      
    
    {\displaystyle N_{i}}
   are treated as independent of all the other data generating variables (
  
    
      
        w
      
    
    {\displaystyle w}
   and 
  
    
      
        z
      
    
    {\displaystyle z}
  ). The subscript is often dropped, as in the plate diagrams shown here.


=== Definition ===
A formal description of LDA is as follows:
We can then mathematically describe the random variables as follows:

  
    
      
        
          
            
              
                
                  
                    φ
                  
                  
                    k
                    =
                    1
                    …
                    K
                  
                
              
              
                
                ∼
                
                  Dirichlet
                  
                    V
                  
                
                ⁡
                (
                
                  β
                
                )
              
            
            
              
                
                  
                    θ
                  
                  
                    d
                    =
                    1
                    …
                    M
                  
                
              
              
                
                ∼
                
                  Dirichlet
                  
                    K
                  
                
                ⁡
                (
                
                  α
                
                )
              
            
            
              
                
                  z
                  
                    d
                    =
                    1
                    …
                    M
                    ,
                    w
                    =
                    1
                    …
                    
                      N
                      
                        d
                      
                    
                  
                
              
              
                
                ∼
                
                  Categorical
                  
                    K
                  
                
                ⁡
                (
                
                  
                    θ
                  
                  
                    d
                  
                
                )
              
            
            
              
                
                  w
                  
                    d
                    =
                    1
                    …
                    M
                    ,
                    w
                    =
                    1
                    …
                    
                      N
                      
                        d
                      
                    
                  
                
              
              
                
                ∼
                
                  Categorical
                  
                    V
                  
                
                ⁡
                (
                
                  
                    φ
                  
                  
                    
                      z
                      
                        d
                        w
                      
                    
                  
                
                )
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}{\boldsymbol {\varphi }}_{k=1\dots K}&\sim \operatorname {Dirichlet} _{V}({\boldsymbol {\beta }})\\{\boldsymbol {\theta }}_{d=1\dots M}&\sim \operatorname {Dirichlet} _{K}({\boldsymbol {\alpha }})\\z_{d=1\dots M,w=1\dots N_{d}}&\sim \operatorname {Categorical} _{K}({\boldsymbol {\theta }}_{d})\\w_{d=1\dots M,w=1\dots N_{d}}&\sim \operatorname {Categorical} _{V}({\boldsymbol {\varphi }}_{z_{dw}})\end{aligned}}}
  


== Inference ==

Learning the various distributions (the set of topics, their associated word probabilities, the topic of each word, and the particular topic mixture of each document) is a problem of Bayesian inference. The original paper used a variational Bayes approximation of the posterior distribution; alternative inference techniques use Gibbs sampling and expectation propagation.
Following is the derivation of the equations for collapsed Gibbs sampling, which means 
  
    
      
        φ
      
    
    {\displaystyle \varphi }
  s and 
  
    
      
        θ
      
    
    {\displaystyle \theta }
  s will be integrated out. For simplicity, in this derivation the documents are all assumed to have the same length 
  
    
      
        
          N
          

          
        
      
    
    {\displaystyle N_{}}
  . The derivation is equally valid if the document lengths vary.
According to the model, the total probability of the model is:

  
    
      
        P
        (
        
          W
        
        ,
        
          Z
        
        ,
        
          θ
        
        ,
        
          φ
        
        ;
        α
        ,
        β
        )
        =
        
          ∏
          
            i
            =
            1
          
          
            K
          
        
        P
        (
        
          φ
          
            i
          
        
        ;
        β
        )
        
          ∏
          
            j
            =
            1
          
          
            M
          
        
        P
        (
        
          θ
          
            j
          
        
        ;
        α
        )
        
          ∏
          
            t
            =
            1
          
          
            N
          
        
        P
        (
        
          Z
          
            j
            ,
            t
          
        
        ∣
        
          θ
          
            j
          
        
        )
        P
        (
        
          W
          
            j
            ,
            t
          
        
        ∣
        
          φ
          
            
              Z
              
                j
                ,
                t
              
            
          
        
        )
        ,
      
    
    {\displaystyle P({\boldsymbol {W}},{\boldsymbol {Z}},{\boldsymbol {\theta }},{\boldsymbol {\varphi }};\alpha ,\beta )=\prod _{i=1}^{K}P(\varphi _{i};\beta )\prod _{j=1}^{M}P(\theta _{j};\alpha )\prod _{t=1}^{N}P(Z_{j,t}\mid \theta _{j})P(W_{j,t}\mid \varphi _{Z_{j,t}}),}
  
where the bold-font variables denote the vector version of the variables. First, 
  
    
      
        
          φ
        
      
    
    {\displaystyle {\boldsymbol {\varphi }}}
   and 
  
    
      
        
          θ
        
      
    
    {\displaystyle {\boldsymbol {\theta }}}
   need to be integrated out.

  
    
      
        
          
            
              
              
                P
                (
                
                  Z
                
                ,
                
                  W
                
                ;
                α
                ,
                β
                )
                =
                
                  ∫
                  
                    θ
                  
                
                
                  ∫
                  
                    φ
                  
                
                P
                (
                
                  W
                
                ,
                
                  Z
                
                ,
                
                  θ
                
                ,
                
                  φ
                
                ;
                α
                ,
                β
                )
                
                d
                
                  φ
                
                
                d
                
                  θ
                
              
            
            
              
                =
                

                
              
              
                
                
                  ∫
                  
                    φ
                  
                
                
                  ∏
                  
                    i
                    =
                    1
                  
                  
                    K
                  
                
                P
                (
                
                  φ
                  
                    i
                  
                
                ;
                β
                )
                
                  ∏
                  
                    j
                    =
                    1
                  
                  
                    M
                  
                
                
                  ∏
                  
                    t
                    =
                    1
                  
                  
                    N
                  
                
                P
                (
                
                  W
                  
                    j
                    ,
                    t
                  
                
                ∣
                
                  φ
                  
                    
                      Z
                      
                        j
                        ,
                        t
                      
                    
                  
                
                )
                
                d
                
                  φ
                
                
                  ∫
                  
                    θ
                  
                
                
                  ∏
                  
                    j
                    =
                    1
                  
                  
                    M
                  
                
                P
                (
                
                  θ
                  
                    j
                  
                
                ;
                α
                )
                
                  ∏
                  
                    t
                    =
                    1
                  
                  
                    N
                  
                
                P
                (
                
                  Z
                  
                    j
                    ,
                    t
                  
                
                ∣
                
                  θ
                  
                    j
                  
                
                )
                
                d
                
                  θ
                
                .
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}&P({\boldsymbol {Z}},{\boldsymbol {W}};\alpha ,\beta )=\int _{\boldsymbol {\theta }}\int _{\boldsymbol {\varphi }}P({\boldsymbol {W}},{\boldsymbol {Z}},{\boldsymbol {\theta }},{\boldsymbol {\varphi }};\alpha ,\beta )\,d{\boldsymbol {\varphi }}\,d{\boldsymbol {\theta }}\\={}&\int _{\boldsymbol {\varphi }}\prod _{i=1}^{K}P(\varphi _{i};\beta )\prod _{j=1}^{M}\prod _{t=1}^{N}P(W_{j,t}\mid \varphi _{Z_{j,t}})\,d{\boldsymbol {\varphi }}\int _{\boldsymbol {\theta }}\prod _{j=1}^{M}P(\theta _{j};\alpha )\prod _{t=1}^{N}P(Z_{j,t}\mid \theta _{j})\,d{\boldsymbol {\theta }}.\end{aligned}}}
  
All the 
  
    
      
        θ
      
    
    {\displaystyle \theta }
  s are independent to each other and the same to all the 
  
    
      
        φ
      
    
    {\displaystyle \varphi }
  s. So we can treat each 
  
    
      
        θ
      
    
    {\displaystyle \theta }
   and each 
  
    
      
        φ
      
    
    {\displaystyle \varphi }
   separately. We now focus only on the 
  
    
      
        θ
      
    
    {\displaystyle \theta }
   part.

  
    
      
        
          ∫
          
            θ
          
        
        
          ∏
          
            j
            =
            1
          
          
            M
          
        
        P
        (
        
          θ
          
            j
          
        
        ;
        α
        )
        
          ∏
          
            t
            =
            1
          
          
            N
          
        
        P
        (
        
          Z
          
            j
            ,
            t
          
        
        ∣
        
          θ
          
            j
          
        
        )
        
        d
        
          θ
        
        =
        
          ∏
          
            j
            =
            1
          
          
            M
          
        
        
          ∫
          
            
              θ
              
                j
              
            
          
        
        P
        (
        
          θ
          
            j
          
        
        ;
        α
        )
        
          ∏
          
            t
            =
            1
          
          
            N
          
        
        P
        (
        
          Z
          
            j
            ,
            t
          
        
        ∣
        
          θ
          
            j
          
        
        )
        
        d
        
          θ
          
            j
          
        
        .
      
    
    {\displaystyle \int _{\boldsymbol {\theta }}\prod _{j=1}^{M}P(\theta _{j};\alpha )\prod _{t=1}^{N}P(Z_{j,t}\mid \theta _{j})\,d{\boldsymbol {\theta }}=\prod _{j=1}^{M}\int _{\theta _{j}}P(\theta _{j};\alpha )\prod _{t=1}^{N}P(Z_{j,t}\mid \theta _{j})\,d\theta _{j}.}
  
We can further focus on only one 
  
    
      
        θ
      
    
    {\displaystyle \theta }
   as the following:

  
    
      
        
          ∫
          
            
              θ
              
                j
              
            
          
        
        P
        (
        
          θ
          
            j
          
        
        ;
        α
        )
        
          ∏
          
            t
            =
            1
          
          
            N
          
        
        P
        (
        
          Z
          
            j
            ,
            t
          
        
        ∣
        
          θ
          
            j
          
        
        )
        
        d
        
          θ
          
            j
          
        
        .
      
    
    {\displaystyle \int _{\theta _{j}}P(\theta _{j};\alpha )\prod _{t=1}^{N}P(Z_{j,t}\mid \theta _{j})\,d\theta _{j}.}
  
Actually, it is the hidden part of the model for the 
  
    
      
        
          j
          
            t
            h
          
        
      
    
    {\displaystyle j^{th}}
   document. Now we replace the probabilities in the above equation by the true distribution expression to write out the explicit equation.

  
    
      
        
          ∫
          
            
              θ
              
                j
              
            
          
        
        P
        (
        
          θ
          
            j
          
        
        ;
        α
        )
        
          ∏
          
            t
            =
            1
          
          
            N
          
        
        P
        (
        
          Z
          
            j
            ,
            t
          
        
        ∣
        
          θ
          
            j
          
        
        )
        
        d
        
          θ
          
            j
          
        
        =
        
          ∫
          
            
              θ
              
                j
              
            
          
        
        
          
            
              Γ
              
                (
                
                  ∑
                  
                    i
                    =
                    1
                  
                  
                    K
                  
                
                
                  α
                  
                    i
                  
                
                )
              
            
            
              
                ∏
                
                  i
                  =
                  1
                
                
                  K
                
              
              Γ
              (
              
                α
                
                  i
                
              
              )
            
          
        
        
          ∏
          
            i
            =
            1
          
          
            K
          
        
        
          θ
          
            j
            ,
            i
          
          
            
              α
              
                i
              
            
            −
            1
          
        
        
          ∏
          
            t
            =
            1
          
          
            N
          
        
        P
        (
        
          Z
          
            j
            ,
            t
          
        
        ∣
        
          θ
          
            j
          
        
        )
        
        d
        
          θ
          
            j
          
        
        .
      
    
    {\displaystyle \int _{\theta _{j}}P(\theta _{j};\alpha )\prod _{t=1}^{N}P(Z_{j,t}\mid \theta _{j})\,d\theta _{j}=\int _{\theta _{j}}{\frac {\Gamma \left(\sum _{i=1}^{K}\alpha _{i}\right)}{\prod _{i=1}^{K}\Gamma (\alpha _{i})}}\prod _{i=1}^{K}\theta _{j,i}^{\alpha _{i}-1}\prod _{t=1}^{N}P(Z_{j,t}\mid \theta _{j})\,d\theta _{j}.}
  
Let 
  
    
      
        
          n
          
            j
            ,
            r
          
          
            i
          
        
      
    
    {\displaystyle n_{j,r}^{i}}
   be the number of word tokens in the 
  
    
      
        
          j
          
            t
            h
          
        
      
    
    {\displaystyle j^{th}}
   document with the same word symbol (the 
  
    
      
        
          r
          
            t
            h
          
        
      
    
    {\displaystyle r^{th}}
   word in the vocabulary) assigned to the 
  
    
      
        
          i
          
            t
            h
          
        
      
    
    {\displaystyle i^{th}}
   topic. So, 
  
    
      
        
          n
          
            j
            ,
            r
          
          
            i
          
        
      
    
    {\displaystyle n_{j,r}^{i}}
   is three dimensional. If any of the three dimensions is not limited to a specific value, we use a parenthesized point 
  
    
      
        (
        ⋅
        )
      
    
    {\displaystyle (\cdot )}
   to denote. For example, 
  
    
      
        
          n
          
            j
            ,
            (
            ⋅
            )
          
          
            i
          
        
      
    
    {\displaystyle n_{j,(\cdot )}^{i}}
   denotes the number of word tokens in the 
  
    
      
        
          j
          
            t
            h
          
        
      
    
    {\displaystyle j^{th}}
   document assigned to the 
  
    
      
        
          i
          
            t
            h
          
        
      
    
    {\displaystyle i^{th}}
   topic. Thus, the right most part of the above equation can be rewritten as:

  
    
      
        
          ∏
          
            t
            =
            1
          
          
            N
          
        
        P
        (
        
          Z
          
            j
            ,
            t
          
        
        ∣
        
          θ
          
            j
          
        
        )
        =
        
          ∏
          
            i
            =
            1
          
          
            K
          
        
        
          θ
          
            j
            ,
            i
          
          
            
              n
              
                j
                ,
                (
                ⋅
                )
              
              
                i
              
            
          
        
        .
      
    
    {\displaystyle \prod _{t=1}^{N}P(Z_{j,t}\mid \theta _{j})=\prod _{i=1}^{K}\theta _{j,i}^{n_{j,(\cdot )}^{i}}.}
  
So the 
  
    
      
        
          θ
          
            j
          
        
      
    
    {\displaystyle \theta _{j}}
   integration formula can be changed to:

  
    
      
        
          ∫
          
            
              θ
              
                j
              
            
          
        
        
          
            
              Γ
              
                (
                
                  ∑
                  
                    i
                    =
                    1
                  
                  
                    K
                  
                
                
                  α
                  
                    i
                  
                
                )
              
            
            
              
                ∏
                
                  i
                  =
                  1
                
                
                  K
                
              
              Γ
              (
              
                α
                
                  i
                
              
              )
            
          
        
        
          ∏
          
            i
            =
            1
          
          
            K
          
        
        
          θ
          
            j
            ,
            i
          
          
            
              α
              
                i
              
            
            −
            1
          
        
        
          ∏
          
            i
            =
            1
          
          
            K
          
        
        
          θ
          
            j
            ,
            i
          
          
            
              n
              
                j
                ,
                (
                ⋅
                )
              
              
                i
              
            
          
        
        
        d
        
          θ
          
            j
          
        
        =
        
          ∫
          
            
              θ
              
                j
              
            
          
        
        
          
            
              Γ
              
                (
                
                  ∑
                  
                    i
                    =
                    1
                  
                  
                    K
                  
                
                
                  α
                  
                    i
                  
                
                )
              
            
            
              
                ∏
                
                  i
                  =
                  1
                
                
                  K
                
              
              Γ
              (
              
                α
                
                  i
                
              
              )
            
          
        
        
          ∏
          
            i
            =
            1
          
          
            K
          
        
        
          θ
          
            j
            ,
            i
          
          
            
              n
              
                j
                ,
                (
                ⋅
                )
              
              
                i
              
            
            +
            
              α
              
                i
              
            
            −
            1
          
        
        
        d
        
          θ
          
            j
          
        
        .
      
    
    {\displaystyle \int _{\theta _{j}}{\frac {\Gamma \left(\sum _{i=1}^{K}\alpha _{i}\right)}{\prod _{i=1}^{K}\Gamma (\alpha _{i})}}\prod _{i=1}^{K}\theta _{j,i}^{\alpha _{i}-1}\prod _{i=1}^{K}\theta _{j,i}^{n_{j,(\cdot )}^{i}}\,d\theta _{j}=\int _{\theta _{j}}{\frac {\Gamma \left(\sum _{i=1}^{K}\alpha _{i}\right)}{\prod _{i=1}^{K}\Gamma (\alpha _{i})}}\prod _{i=1}^{K}\theta _{j,i}^{n_{j,(\cdot )}^{i}+\alpha _{i}-1}\,d\theta _{j}.}
  
Clearly, the equation inside the integration has the same form as the Dirichlet distribution. According to the Dirichlet distribution,

  
    
      
        
          ∫
          
            
              θ
              
                j
              
            
          
        
        
          
            
              Γ
              
                (
                
                  ∑
                  
                    i
                    =
                    1
                  
                  
                    K
                  
                
                
                  n
                  
                    j
                    ,
                    (
                    ⋅
                    )
                  
                  
                    i
                  
                
                +
                
                  α
                  
                    i
                  
                
                )
              
            
            
              
                ∏
                
                  i
                  =
                  1
                
                
                  K
                
              
              Γ
              (
              
                n
                
                  j
                  ,
                  (
                  ⋅
                  )
                
                
                  i
                
              
              +
              
                α
                
                  i
                
              
              )
            
          
        
        
          ∏
          
            i
            =
            1
          
          
            K
          
        
        
          θ
          
            j
            ,
            i
          
          
            
              n
              
                j
                ,
                (
                ⋅
                )
              
              
                i
              
            
            +
            
              α
              
                i
              
            
            −
            1
          
        
        
        d
        
          θ
          
            j
          
        
        =
        1.
      
    
    {\displaystyle \int _{\theta _{j}}{\frac {\Gamma \left(\sum _{i=1}^{K}n_{j,(\cdot )}^{i}+\alpha _{i}\right)}{\prod _{i=1}^{K}\Gamma (n_{j,(\cdot )}^{i}+\alpha _{i})}}\prod _{i=1}^{K}\theta _{j,i}^{n_{j,(\cdot )}^{i}+\alpha _{i}-1}\,d\theta _{j}=1.}
  
Thus,

  
    
      
        
          
            
              
              
                
                
                  ∫
                  
                    
                      θ
                      
                        j
                      
                    
                  
                
                P
                (
                
                  θ
                  
                    j
                  
                
                ;
                α
                )
                
                  ∏
                  
                    t
                    =
                    1
                  
                  
                    N
                  
                
                P
                (
                
                  Z
                  
                    j
                    ,
                    t
                  
                
                ∣
                
                  θ
                  
                    j
                  
                
                )
                
                d
                
                  θ
                  
                    j
                  
                
                =
                
                  ∫
                  
                    
                      θ
                      
                        j
                      
                    
                  
                
                
                  
                    
                      Γ
                      
                        (
                        
                          ∑
                          
                            i
                            =
                            1
                          
                          
                            K
                          
                        
                        
                          α
                          
                            i
                          
                        
                        )
                      
                    
                    
                      
                        ∏
                        
                          i
                          =
                          1
                        
                        
                          K
                        
                      
                      Γ
                      (
                      
                        α
                        
                          i
                        
                      
                      )
                    
                  
                
                
                  ∏
                  
                    i
                    =
                    1
                  
                  
                    K
                  
                
                
                  θ
                  
                    j
                    ,
                    i
                  
                  
                    
                      n
                      
                        j
                        ,
                        (
                        ⋅
                        )
                      
                      
                        i
                      
                    
                    +
                    
                      α
                      
                        i
                      
                    
                    −
                    1
                  
                
                
                d
                
                  θ
                  
                    j
                  
                
              
            
            
              
                =
                

                
              
              
                
                  
                    
                      Γ
                      
                        (
                        
                          ∑
                          
                            i
                            =
                            1
                          
                          
                            K
                          
                        
                        
                          α
                          
                            i
                          
                        
                        )
                      
                    
                    
                      
                        ∏
                        
                          i
                          =
                          1
                        
                        
                          K
                        
                      
                      Γ
                      (
                      
                        α
                        
                          i
                        
                      
                      )
                    
                  
                
                
                  
                    
                      
                        ∏
                        
                          i
                          =
                          1
                        
                        
                          K
                        
                      
                      Γ
                      (
                      
                        n
                        
                          j
                          ,
                          (
                          ⋅
                          )
                        
                        
                          i
                        
                      
                      +
                      
                        α
                        
                          i
                        
                      
                      )
                    
                    
                      Γ
                      
                        (
                        
                          ∑
                          
                            i
                            =
                            1
                          
                          
                            K
                          
                        
                        
                          n
                          
                            j
                            ,
                            (
                            ⋅
                            )
                          
                          
                            i
                          
                        
                        +
                        
                          α
                          
                            i
                          
                        
                        )
                      
                    
                  
                
                
                  ∫
                  
                    
                      θ
                      
                        j
                      
                    
                  
                
                
                  
                    
                      Γ
                      
                        (
                        
                          ∑
                          
                            i
                            =
                            1
                          
                          
                            K
                          
                        
                        
                          n
                          
                            j
                            ,
                            (
                            ⋅
                            )
                          
                          
                            i
                          
                        
                        +
                        
                          α
                          
                            i
                          
                        
                        )
                      
                    
                    
                      
                        ∏
                        
                          i
                          =
                          1
                        
                        
                          K
                        
                      
                      Γ
                      (
                      
                        n
                        
                          j
                          ,
                          (
                          ⋅
                          )
                        
                        
                          i
                        
                      
                      +
                      
                        α
                        
                          i
                        
                      
                      )
                    
                  
                
                
                  ∏
                  
                    i
                    =
                    1
                  
                  
                    K
                  
                
                
                  θ
                  
                    j
                    ,
                    i
                  
                  
                    
                      n
                      
                        j
                        ,
                        (
                        ⋅
                        )
                      
                      
                        i
                      
                    
                    +
                    
                      α
                      
                        i
                      
                    
                    −
                    1
                  
                
                
                d
                
                  θ
                  
                    j
                  
                
              
            
            
              
                =
                

                
              
              
                
                  
                    
                      Γ
                      
                        (
                        
                          ∑
                          
                            i
                            =
                            1
                          
                          
                            K
                          
                        
                        
                          α
                          
                            i
                          
                        
                        )
                      
                    
                    
                      
                        ∏
                        
                          i
                          =
                          1
                        
                        
                          K
                        
                      
                      Γ
                      (
                      
                        α
                        
                          i
                        
                      
                      )
                    
                  
                
                
                  
                    
                      
                        ∏
                        
                          i
                          =
                          1
                        
                        
                          K
                        
                      
                      Γ
                      (
                      
                        n
                        
                          j
                          ,
                          (
                          ⋅
                          )
                        
                        
                          i
                        
                      
                      +
                      
                        α
                        
                          i
                        
                      
                      )
                    
                    
                      Γ
                      
                        (
                        
                          ∑
                          
                            i
                            =
                            1
                          
                          
                            K
                          
                        
                        
                          n
                          
                            j
                            ,
                            (
                            ⋅
                            )
                          
                          
                            i
                          
                        
                        +
                        
                          α
                          
                            i
                          
                        
                        )
                      
                    
                  
                
                .
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}&\int _{\theta _{j}}P(\theta _{j};\alpha )\prod _{t=1}^{N}P(Z_{j,t}\mid \theta _{j})\,d\theta _{j}=\int _{\theta _{j}}{\frac {\Gamma \left(\sum _{i=1}^{K}\alpha _{i}\right)}{\prod _{i=1}^{K}\Gamma (\alpha _{i})}}\prod _{i=1}^{K}\theta _{j,i}^{n_{j,(\cdot )}^{i}+\alpha _{i}-1}\,d\theta _{j}\\[8pt]={}&{\frac {\Gamma \left(\sum _{i=1}^{K}\alpha _{i}\right)}{\prod _{i=1}^{K}\Gamma (\alpha _{i})}}{\frac {\prod _{i=1}^{K}\Gamma (n_{j,(\cdot )}^{i}+\alpha _{i})}{\Gamma \left(\sum _{i=1}^{K}n_{j,(\cdot )}^{i}+\alpha _{i}\right)}}\int _{\theta _{j}}{\frac {\Gamma \left(\sum _{i=1}^{K}n_{j,(\cdot )}^{i}+\alpha _{i}\right)}{\prod _{i=1}^{K}\Gamma (n_{j,(\cdot )}^{i}+\alpha _{i})}}\prod _{i=1}^{K}\theta _{j,i}^{n_{j,(\cdot )}^{i}+\alpha _{i}-1}\,d\theta _{j}\\[8pt]={}&{\frac {\Gamma \left(\sum _{i=1}^{K}\alpha _{i}\right)}{\prod _{i=1}^{K}\Gamma (\alpha _{i})}}{\frac {\prod _{i=1}^{K}\Gamma (n_{j,(\cdot )}^{i}+\alpha _{i})}{\Gamma \left(\sum _{i=1}^{K}n_{j,(\cdot )}^{i}+\alpha _{i}\right)}}.\end{aligned}}}
  
Now we turn our attention to the 
  
    
      
        
          φ
        
      
    
    {\displaystyle {\boldsymbol {\varphi }}}
   part. Actually, the derivation of the 
  
    
      
        
          φ
        
      
    
    {\displaystyle {\boldsymbol {\varphi }}}
   part is very similar to the 
  
    
      
        
          θ
        
      
    
    {\displaystyle {\boldsymbol {\theta }}}
   part. Here we only list the steps of the derivation:

  
    
      
        
          
            
              
              
                
                
                  ∫
                  
                    φ
                  
                
                
                  ∏
                  
                    i
                    =
                    1
                  
                  
                    K
                  
                
                P
                (
                
                  φ
                  
                    i
                  
                
                ;
                β
                )
                
                  ∏
                  
                    j
                    =
                    1
                  
                  
                    M
                  
                
                
                  ∏
                  
                    t
                    =
                    1
                  
                  
                    N
                  
                
                P
                (
                
                  W
                  
                    j
                    ,
                    t
                  
                
                ∣
                
                  φ
                  
                    
                      Z
                      
                        j
                        ,
                        t
                      
                    
                  
                
                )
                
                d
                
                  φ
                
              
            
            
              
                =
                

                
              
              
                
                
                  ∏
                  
                    i
                    =
                    1
                  
                  
                    K
                  
                
                
                  ∫
                  
                    
                      φ
                      
                        i
                      
                    
                  
                
                P
                (
                
                  φ
                  
                    i
                  
                
                ;
                β
                )
                
                  ∏
                  
                    j
                    =
                    1
                  
                  
                    M
                  
                
                
                  ∏
                  
                    t
                    =
                    1
                  
                  
                    N
                  
                
                P
                (
                
                  W
                  
                    j
                    ,
                    t
                  
                
                ∣
                
                  φ
                  
                    
                      Z
                      
                        j
                        ,
                        t
                      
                    
                  
                
                )
                
                d
                
                  φ
                  
                    i
                  
                
              
            
            
              
                =
                

                
              
              
                
                
                  ∏
                  
                    i
                    =
                    1
                  
                  
                    K
                  
                
                
                  ∫
                  
                    
                      φ
                      
                        i
                      
                    
                  
                
                
                  
                    
                      Γ
                      
                        (
                        
                          ∑
                          
                            r
                            =
                            1
                          
                          
                            V
                          
                        
                        
                          β
                          
                            r
                          
                        
                        )
                      
                    
                    
                      
                        ∏
                        
                          r
                          =
                          1
                        
                        
                          V
                        
                      
                      Γ
                      (
                      
                        β
                        
                          r
                        
                      
                      )
                    
                  
                
                
                  ∏
                  
                    r
                    =
                    1
                  
                  
                    V
                  
                
                
                  φ
                  
                    i
                    ,
                    r
                  
                  
                    
                      β
                      
                        r
                      
                    
                    −
                    1
                  
                
                
                  ∏
                  
                    r
                    =
                    1
                  
                  
                    V
                  
                
                
                  φ
                  
                    i
                    ,
                    r
                  
                  
                    
                      n
                      
                        (
                        ⋅
                        )
                        ,
                        r
                      
                      
                        i
                      
                    
                  
                
                
                d
                
                  φ
                  
                    i
                  
                
              
            
            
              
                =
                

                
              
              
                
                
                  ∏
                  
                    i
                    =
                    1
                  
                  
                    K
                  
                
                
                  ∫
                  
                    
                      φ
                      
                        i
                      
                    
                  
                
                
                  
                    
                      Γ
                      
                        (
                        
                          ∑
                          
                            r
                            =
                            1
                          
                          
                            V
                          
                        
                        
                          β
                          
                            r
                          
                        
                        )
                      
                    
                    
                      
                        ∏
                        
                          r
                          =
                          1
                        
                        
                          V
                        
                      
                      Γ
                      (
                      
                        β
                        
                          r
                        
                      
                      )
                    
                  
                
                
                  ∏
                  
                    r
                    =
                    1
                  
                  
                    V
                  
                
                
                  φ
                  
                    i
                    ,
                    r
                  
                  
                    
                      n
                      
                        (
                        ⋅
                        )
                        ,
                        r
                      
                      
                        i
                      
                    
                    +
                    
                      β
                      
                        r
                      
                    
                    −
                    1
                  
                
                
                d
                
                  φ
                  
                    i
                  
                
              
            
            
              
                =
                

                
              
              
                
                
                  ∏
                  
                    i
                    =
                    1
                  
                  
                    K
                  
                
                
                  
                    
                      Γ
                      
                        (
                        
                          ∑
                          
                            r
                            =
                            1
                          
                          
                            V
                          
                        
                        
                          β
                          
                            r
                          
                        
                        )
                      
                    
                    
                      
                        ∏
                        
                          r
                          =
                          1
                        
                        
                          V
                        
                      
                      Γ
                      (
                      
                        β
                        
                          r
                        
                      
                      )
                    
                  
                
                
                  
                    
                      
                        ∏
                        
                          r
                          =
                          1
                        
                        
                          V
                        
                      
                      Γ
                      (
                      
                        n
                        
                          (
                          ⋅
                          )
                          ,
                          r
                        
                        
                          i
                        
                      
                      +
                      
                        β
                        
                          r
                        
                      
                      )
                    
                    
                      Γ
                      
                        (
                        
                          ∑
                          
                            r
                            =
                            1
                          
                          
                            V
                          
                        
                        
                          n
                          
                            (
                            ⋅
                            )
                            ,
                            r
                          
                          
                            i
                          
                        
                        +
                        
                          β
                          
                            r
                          
                        
                        )
                      
                    
                  
                
                .
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}&\int _{\boldsymbol {\varphi }}\prod _{i=1}^{K}P(\varphi _{i};\beta )\prod _{j=1}^{M}\prod _{t=1}^{N}P(W_{j,t}\mid \varphi _{Z_{j,t}})\,d{\boldsymbol {\varphi }}\\[8pt]={}&\prod _{i=1}^{K}\int _{\varphi _{i}}P(\varphi _{i};\beta )\prod _{j=1}^{M}\prod _{t=1}^{N}P(W_{j,t}\mid \varphi _{Z_{j,t}})\,d\varphi _{i}\\[8pt]={}&\prod _{i=1}^{K}\int _{\varphi _{i}}{\frac {\Gamma \left(\sum _{r=1}^{V}\beta _{r}\right)}{\prod _{r=1}^{V}\Gamma (\beta _{r})}}\prod _{r=1}^{V}\varphi _{i,r}^{\beta _{r}-1}\prod _{r=1}^{V}\varphi _{i,r}^{n_{(\cdot ),r}^{i}}\,d\varphi _{i}\\[8pt]={}&\prod _{i=1}^{K}\int _{\varphi _{i}}{\frac {\Gamma \left(\sum _{r=1}^{V}\beta _{r}\right)}{\prod _{r=1}^{V}\Gamma (\beta _{r})}}\prod _{r=1}^{V}\varphi _{i,r}^{n_{(\cdot ),r}^{i}+\beta _{r}-1}\,d\varphi _{i}\\[8pt]={}&\prod _{i=1}^{K}{\frac {\Gamma \left(\sum _{r=1}^{V}\beta _{r}\right)}{\prod _{r=1}^{V}\Gamma (\beta _{r})}}{\frac {\prod _{r=1}^{V}\Gamma (n_{(\cdot ),r}^{i}+\beta _{r})}{\Gamma \left(\sum _{r=1}^{V}n_{(\cdot ),r}^{i}+\beta _{r}\right)}}.\end{aligned}}}
  
For clarity, here we write down the final equation with both 
  
    
      
        
          ϕ
        
      
    
    {\displaystyle {\boldsymbol {\phi }}}
   and 
  
    
      
        
          θ
        
      
    
    {\displaystyle {\boldsymbol {\theta }}}
   integrated out:

  
    
      
        P
        (
        
          Z
        
        ,
        
          W
        
        ;
        α
        ,
        β
        )
        =
        
          ∏
          
            j
            =
            1
          
          
            M
          
        
        
          
            
              Γ
              
                (
                
                  ∑
                  
                    i
                    =
                    1
                  
                  
                    K
                  
                
                
                  α
                  
                    i
                  
                
                )
              
            
            
              
                ∏
                
                  i
                  =
                  1
                
                
                  K
                
              
              Γ
              (
              
                α
                
                  i
                
              
              )
            
          
        
        
          
            
              
                ∏
                
                  i
                  =
                  1
                
                
                  K
                
              
              Γ
              (
              
                n
                
                  j
                  ,
                  (
                  ⋅
                  )
                
                
                  i
                
              
              +
              
                α
                
                  i
                
              
              )
            
            
              Γ
              
                (
                
                  ∑
                  
                    i
                    =
                    1
                  
                  
                    K
                  
                
                
                  n
                  
                    j
                    ,
                    (
                    ⋅
                    )
                  
                  
                    i
                  
                
                +
                
                  α
                  
                    i
                  
                
                )
              
            
          
        
        ×
        
          ∏
          
            i
            =
            1
          
          
            K
          
        
        
          
            
              Γ
              
                (
                
                  ∑
                  
                    r
                    =
                    1
                  
                  
                    V
                  
                
                
                  β
                  
                    r
                  
                
                )
              
            
            
              
                ∏
                
                  r
                  =
                  1
                
                
                  V
                
              
              Γ
              (
              
                β
                
                  r
                
              
              )
            
          
        
        
          
            
              
                ∏
                
                  r
                  =
                  1
                
                
                  V
                
              
              Γ
              (
              
                n
                
                  (
                  ⋅
                  )
                  ,
                  r
                
                
                  i
                
              
              +
              
                β
                
                  r
                
              
              )
            
            
              Γ
              
                (
                
                  ∑
                  
                    r
                    =
                    1
                  
                  
                    V
                  
                
                
                  n
                  
                    (
                    ⋅
                    )
                    ,
                    r
                  
                  
                    i
                  
                
                +
                
                  β
                  
                    r
                  
                
                )
              
            
          
        
        .
      
    
    {\displaystyle P({\boldsymbol {Z}},{\boldsymbol {W}};\alpha ,\beta )=\prod _{j=1}^{M}{\frac {\Gamma \left(\sum _{i=1}^{K}\alpha _{i}\right)}{\prod _{i=1}^{K}\Gamma (\alpha _{i})}}{\frac {\prod _{i=1}^{K}\Gamma (n_{j,(\cdot )}^{i}+\alpha _{i})}{\Gamma \left(\sum _{i=1}^{K}n_{j,(\cdot )}^{i}+\alpha _{i}\right)}}\times \prod _{i=1}^{K}{\frac {\Gamma \left(\sum _{r=1}^{V}\beta _{r}\right)}{\prod _{r=1}^{V}\Gamma (\beta _{r})}}{\frac {\prod _{r=1}^{V}\Gamma (n_{(\cdot ),r}^{i}+\beta _{r})}{\Gamma \left(\sum _{r=1}^{V}n_{(\cdot ),r}^{i}+\beta _{r}\right)}}.}
  
The goal of Gibbs Sampling here is to approximate the distribution of 
  
    
      
        P
        (
        
          Z
        
        ∣
        
          W
        
        ;
        α
        ,
        β
        )
      
    
    {\displaystyle P({\boldsymbol {Z}}\mid {\boldsymbol {W}};\alpha ,\beta )}
  . Since 
  
    
      
        P
        (
        
          W
        
        ;
        α
        ,
        β
        )
      
    
    {\displaystyle P({\boldsymbol {W}};\alpha ,\beta )}
   is invariable for any of Z, Gibbs Sampling equations can be derived from 
  
    
      
        P
        (
        
          Z
        
        ,
        
          W
        
        ;
        α
        ,
        β
        )
      
    
    {\displaystyle P({\boldsymbol {Z}},{\boldsymbol {W}};\alpha ,\beta )}
   directly. The key point is to derive the following conditional probability:

  
    
      
        P
        (
        
          Z
          
            (
            m
            ,
            n
            )
          
        
        ∣
        
          
            Z
            
              −
              (
              m
              ,
              n
              )
            
          
        
        ,
        
          W
        
        ;
        α
        ,
        β
        )
        =
        
          
            
              P
              (
              
                Z
                
                  (
                  m
                  ,
                  n
                  )
                
              
              ,
              
                
                  Z
                  
                    −
                    (
                    m
                    ,
                    n
                    )
                  
                
              
              ,
              
                W
              
              ;
              α
              ,
              β
              )
            
            
              P
              (
              
                
                  Z
                  
                    −
                    (
                    m
                    ,
                    n
                    )
                  
                
              
              ,
              
                W
              
              ;
              α
              ,
              β
              )
            
          
        
        ,
      
    
    {\displaystyle P(Z_{(m,n)}\mid {\boldsymbol {Z_{-(m,n)}}},{\boldsymbol {W}};\alpha ,\beta )={\frac {P(Z_{(m,n)},{\boldsymbol {Z_{-(m,n)}}},{\boldsymbol {W}};\alpha ,\beta )}{P({\boldsymbol {Z_{-(m,n)}}},{\boldsymbol {W}};\alpha ,\beta )}},}
  
where 
  
    
      
        
          Z
          
            (
            m
            ,
            n
            )
          
        
      
    
    {\displaystyle Z_{(m,n)}}
   denotes the 
  
    
      
        Z
      
    
    {\displaystyle Z}
   hidden variable of the 
  
    
      
        
          n
          
            t
            h
          
        
      
    
    {\displaystyle n^{th}}
   word token in the 
  
    
      
        
          m
          
            t
            h
          
        
      
    
    {\displaystyle m^{th}}
   document. And further we assume that the word symbol of it is the 
  
    
      
        
          v
          
            t
            h
          
        
      
    
    {\displaystyle v^{th}}
   word in the vocabulary. 
  
    
      
        
          
            Z
            
              −
              (
              m
              ,
              n
              )
            
          
        
      
    
    {\displaystyle {\boldsymbol {Z_{-(m,n)}}}}
   denotes all the 
  
    
      
        Z
      
    
    {\displaystyle Z}
  s but 
  
    
      
        
          Z
          
            (
            m
            ,
            n
            )
          
        
      
    
    {\displaystyle Z_{(m,n)}}
  . Note that Gibbs Sampling needs only to sample a value for 
  
    
      
        
          Z
          
            (
            m
            ,
            n
            )
          
        
      
    
    {\displaystyle Z_{(m,n)}}
  , according to the above probability, we do not need the exact value of

  
    
      
        P
        
          (
          
            Z
            
              m
              ,
              n
            
          
          ∣
          
            
              Z
              
                −
                (
                m
                ,
                n
                )
              
            
          
          ,
          
            W
          
          ;
          α
          ,
          β
          )
        
      
    
    {\displaystyle P\left(Z_{m,n}\mid {\boldsymbol {Z_{-(m,n)}}},{\boldsymbol {W}};\alpha ,\beta \right)}
  
but the ratios among the probabilities that 
  
    
      
        
          Z
          
            (
            m
            ,
            n
            )
          
        
      
    
    {\displaystyle Z_{(m,n)}}
   can take value. So, the above equation can be simplified as:

  
    
      
        
          
            
              
                P
                (
              
              
                
                  Z
                  
                    (
                    m
                    ,
                    n
                    )
                  
                
                =
                k
                ∣
                
                  
                    Z
                    
                      −
                      (
                      m
                      ,
                      n
                      )
                    
                  
                
                ,
                
                  W
                
                ;
                α
                ,
                β
                )
              
            
            
              
              
                
                ∝
                P
                (
                
                  Z
                  
                    (
                    m
                    ,
                    n
                    )
                  
                
                =
                k
                ,
                
                  
                    Z
                    
                      −
                      (
                      m
                      ,
                      n
                      )
                    
                  
                
                ,
                
                  W
                
                ;
                α
                ,
                β
                )
              
            
            
              
              
                
                =
                
                  
                    (
                    
                      
                        
                          Γ
                          
                            (
                            
                              ∑
                              
                                i
                                =
                                1
                              
                              
                                K
                              
                            
                            
                              α
                              
                                i
                              
                            
                            )
                          
                        
                        
                          
                            ∏
                            
                              i
                              =
                              1
                            
                            
                              K
                            
                          
                          Γ
                          (
                          
                            α
                            
                              i
                            
                          
                          )
                        
                      
                    
                    )
                  
                  
                    M
                  
                
                
                  ∏
                  
                    j
                    ≠
                    m
                  
                
                
                  
                    
                      
                        ∏
                        
                          i
                          =
                          1
                        
                        
                          K
                        
                      
                      Γ
                      
                        (
                        
                          n
                          
                            j
                            ,
                            (
                            ⋅
                            )
                          
                          
                            i
                          
                        
                        +
                        
                          α
                          
                            i
                          
                        
                        )
                      
                    
                    
                      Γ
                      
                        (
                        
                          ∑
                          
                            i
                            =
                            1
                          
                          
                            K
                          
                        
                        
                          n
                          
                            j
                            ,
                            (
                            ⋅
                            )
                          
                          
                            i
                          
                        
                        +
                        
                          α
                          
                            i
                          
                        
                        )
                      
                    
                  
                
                
                  
                    (
                    
                      
                        
                          Γ
                          
                            (
                            
                              ∑
                              
                                r
                                =
                                1
                              
                              
                                V
                              
                            
                            
                              β
                              
                                r
                              
                            
                            )
                          
                        
                        
                          
                            ∏
                            
                              r
                              =
                              1
                            
                            
                              V
                            
                          
                          Γ
                          (
                          
                            β
                            
                              r
                            
                          
                          )
                        
                      
                    
                    )
                  
                  
                    K
                  
                
                
                  ∏
                  
                    i
                    =
                    1
                  
                  
                    K
                  
                
                
                  ∏
                  
                    r
                    ≠
                    v
                  
                
                Γ
                
                  (
                  
                    n
                    
                      (
                      ⋅
                      )
                      ,
                      r
                    
                    
                      i
                    
                  
                  +
                  
                    β
                    
                      r
                    
                  
                  )
                
                
                  
                    
                      
                        ∏
                        
                          i
                          =
                          1
                        
                        
                          K
                        
                      
                      Γ
                      
                        (
                        
                          n
                          
                            m
                            ,
                            (
                            ⋅
                            )
                          
                          
                            i
                          
                        
                        +
                        
                          α
                          
                            i
                          
                        
                        )
                      
                    
                    
                      Γ
                      
                        (
                        
                          ∑
                          
                            i
                            =
                            1
                          
                          
                            K
                          
                        
                        
                          n
                          
                            m
                            ,
                            (
                            ⋅
                            )
                          
                          
                            i
                          
                        
                        +
                        
                          α
                          
                            i
                          
                        
                        )
                      
                    
                  
                
                
                  ∏
                  
                    i
                    =
                    1
                  
                  
                    K
                  
                
                
                  
                    
                      Γ
                      
                        (
                        
                          n
                          
                            (
                            ⋅
                            )
                            ,
                            v
                          
                          
                            i
                          
                        
                        +
                        
                          β
                          
                            v
                          
                        
                        )
                      
                    
                    
                      Γ
                      
                        (
                        
                          ∑
                          
                            r
                            =
                            1
                          
                          
                            V
                          
                        
                        
                          n
                          
                            (
                            ⋅
                            )
                            ,
                            r
                          
                          
                            i
                          
                        
                        +
                        
                          β
                          
                            r
                          
                        
                        )
                      
                    
                  
                
              
            
            
              
              
                
                ∝
                
                  
                    
                      
                        ∏
                        
                          i
                          =
                          1
                        
                        
                          K
                        
                      
                      Γ
                      
                        (
                        
                          n
                          
                            m
                            ,
                            (
                            ⋅
                            )
                          
                          
                            i
                          
                        
                        +
                        
                          α
                          
                            i
                          
                        
                        )
                      
                    
                    
                      Γ
                      
                        (
                        
                          ∑
                          
                            i
                            =
                            1
                          
                          
                            K
                          
                        
                        
                          n
                          
                            m
                            ,
                            (
                            ⋅
                            )
                          
                          
                            i
                          
                        
                        +
                        
                          α
                          
                            i
                          
                        
                        )
                      
                    
                  
                
                
                  ∏
                  
                    i
                    =
                    1
                  
                  
                    K
                  
                
                
                  
                    
                      Γ
                      
                        (
                        
                          n
                          
                            (
                            ⋅
                            )
                            ,
                            v
                          
                          
                            i
                          
                        
                        +
                        
                          β
                          
                            v
                          
                        
                        )
                      
                    
                    
                      Γ
                      
                        (
                        
                          ∑
                          
                            r
                            =
                            1
                          
                          
                            V
                          
                        
                        
                          n
                          
                            (
                            ⋅
                            )
                            ,
                            r
                          
                          
                            i
                          
                        
                        +
                        
                          β
                          
                            r
                          
                        
                        )
                      
                    
                  
                
              
            
            
              
              
                
                ∝
                
                  ∏
                  
                    i
                    =
                    1
                  
                  
                    K
                  
                
                Γ
                
                  (
                  
                    n
                    
                      m
                      ,
                      (
                      ⋅
                      )
                    
                    
                      i
                    
                  
                  +
                  
                    α
                    
                      i
                    
                  
                  )
                
                
                  ∏
                  
                    i
                    =
                    1
                  
                  
                    K
                  
                
                
                  
                    
                      Γ
                      
                        (
                        
                          n
                          
                            (
                            ⋅
                            )
                            ,
                            v
                          
                          
                            i
                          
                        
                        +
                        
                          β
                          
                            v
                          
                        
                        )
                      
                    
                    
                      Γ
                      
                        (
                        
                          ∑
                          
                            r
                            =
                            1
                          
                          
                            V
                          
                        
                        
                          n
                          
                            (
                            ⋅
                            )
                            ,
                            r
                          
                          
                            i
                          
                        
                        +
                        
                          β
                          
                            r
                          
                        
                        )
                      
                    
                  
                
                .
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}P(&Z_{(m,n)}=k\mid {\boldsymbol {Z_{-(m,n)}}},{\boldsymbol {W}};\alpha ,\beta )\\[8pt]&\propto P(Z_{(m,n)}=k,{\boldsymbol {Z_{-(m,n)}}},{\boldsymbol {W}};\alpha ,\beta )\\[8pt]&=\left({\frac {\Gamma \left(\sum _{i=1}^{K}\alpha _{i}\right)}{\prod _{i=1}^{K}\Gamma (\alpha _{i})}}\right)^{M}\prod _{j\neq m}{\frac {\prod _{i=1}^{K}\Gamma \left(n_{j,(\cdot )}^{i}+\alpha _{i}\right)}{\Gamma \left(\sum _{i=1}^{K}n_{j,(\cdot )}^{i}+\alpha _{i}\right)}}\left({\frac {\Gamma \left(\sum _{r=1}^{V}\beta _{r}\right)}{\prod _{r=1}^{V}\Gamma (\beta _{r})}}\right)^{K}\prod _{i=1}^{K}\prod _{r\neq v}\Gamma \left(n_{(\cdot ),r}^{i}+\beta _{r}\right){\frac {\prod _{i=1}^{K}\Gamma \left(n_{m,(\cdot )}^{i}+\alpha _{i}\right)}{\Gamma \left(\sum _{i=1}^{K}n_{m,(\cdot )}^{i}+\alpha _{i}\right)}}\prod _{i=1}^{K}{\frac {\Gamma \left(n_{(\cdot ),v}^{i}+\beta _{v}\right)}{\Gamma \left(\sum _{r=1}^{V}n_{(\cdot ),r}^{i}+\beta _{r}\right)}}\\[8pt]&\propto {\frac {\prod _{i=1}^{K}\Gamma \left(n_{m,(\cdot )}^{i}+\alpha _{i}\right)}{\Gamma \left(\sum _{i=1}^{K}n_{m,(\cdot )}^{i}+\alpha _{i}\right)}}\prod _{i=1}^{K}{\frac {\Gamma \left(n_{(\cdot ),v}^{i}+\beta _{v}\right)}{\Gamma \left(\sum _{r=1}^{V}n_{(\cdot ),r}^{i}+\beta _{r}\right)}}\\[8pt]&\propto \prod _{i=1}^{K}\Gamma \left(n_{m,(\cdot )}^{i}+\alpha _{i}\right)\prod _{i=1}^{K}{\frac {\Gamma \left(n_{(\cdot ),v}^{i}+\beta _{v}\right)}{\Gamma \left(\sum _{r=1}^{V}n_{(\cdot ),r}^{i}+\beta _{r}\right)}}.\end{aligned}}}
  
Finally, let 
  
    
      
        
          n
          
            j
            ,
            r
          
          
            i
            ,
            −
            (
            m
            ,
            n
            )
          
        
      
    
    {\displaystyle n_{j,r}^{i,-(m,n)}}
   be the same meaning as 
  
    
      
        
          n
          
            j
            ,
            r
          
          
            i
          
        
      
    
    {\displaystyle n_{j,r}^{i}}
   but with the 
  
    
      
        
          Z
          
            (
            m
            ,
            n
            )
          
        
      
    
    {\displaystyle Z_{(m,n)}}
   excluded. The above equation can be further simplified leveraging the property of gamma function. We first split the summation and then merge it back to obtain a 
  
    
      
        k
      
    
    {\displaystyle k}
  -independent summation, which could be dropped:

  
    
      
        
          
            
              
              
                
                ∝
                
                  ∏
                  
                    i
                    ≠
                    k
                  
                
                Γ
                
                  (
                  
                    n
                    
                      m
                      ,
                      (
                      ⋅
                      )
                    
                    
                      i
                      ,
                      −
                      (
                      m
                      ,
                      n
                      )
                    
                  
                  +
                  
                    α
                    
                      i
                    
                  
                  )
                
                
                  ∏
                  
                    i
                    ≠
                    k
                  
                
                
                  
                    
                      Γ
                      
                        (
                        
                          n
                          
                            (
                            ⋅
                            )
                            ,
                            v
                          
                          
                            i
                            ,
                            −
                            (
                            m
                            ,
                            n
                            )
                          
                        
                        +
                        
                          β
                          
                            v
                          
                        
                        )
                      
                    
                    
                      Γ
                      
                        (
                        
                          ∑
                          
                            r
                            =
                            1
                          
                          
                            V
                          
                        
                        
                          n
                          
                            (
                            ⋅
                            )
                            ,
                            r
                          
                          
                            i
                            ,
                            −
                            (
                            m
                            ,
                            n
                            )
                          
                        
                        +
                        
                          β
                          
                            r
                          
                        
                        )
                      
                    
                  
                
                Γ
                
                  (
                  
                    n
                    
                      m
                      ,
                      (
                      ⋅
                      )
                    
                    
                      k
                      ,
                      −
                      (
                      m
                      ,
                      n
                      )
                    
                  
                  +
                  
                    α
                    
                      k
                    
                  
                  +
                  1
                  )
                
                
                  
                    
                      Γ
                      
                        (
                        
                          n
                          
                            (
                            ⋅
                            )
                            ,
                            v
                          
                          
                            k
                            ,
                            −
                            (
                            m
                            ,
                            n
                            )
                          
                        
                        +
                        
                          β
                          
                            v
                          
                        
                        +
                        1
                        )
                      
                    
                    
                      Γ
                      
                        (
                        
                          ∑
                          
                            r
                            =
                            1
                          
                          
                            V
                          
                        
                        
                          n
                          
                            (
                            ⋅
                            )
                            ,
                            r
                          
                          
                            k
                            ,
                            −
                            (
                            m
                            ,
                            n
                            )
                          
                        
                        +
                        
                          β
                          
                            r
                          
                        
                        +
                        1
                        )
                      
                    
                  
                
              
            
            
              
              
                
                =
                
                  ∏
                  
                    i
                    ≠
                    k
                  
                
                Γ
                
                  (
                  
                    n
                    
                      m
                      ,
                      (
                      ⋅
                      )
                    
                    
                      i
                      ,
                      −
                      (
                      m
                      ,
                      n
                      )
                    
                  
                  +
                  
                    α
                    
                      i
                    
                  
                  )
                
                
                  ∏
                  
                    i
                    ≠
                    k
                  
                
                
                  
                    
                      Γ
                      
                        (
                        
                          n
                          
                            (
                            ⋅
                            )
                            ,
                            v
                          
                          
                            i
                            ,
                            −
                            (
                            m
                            ,
                            n
                            )
                          
                        
                        +
                        
                          β
                          
                            v
                          
                        
                        )
                      
                    
                    
                      Γ
                      
                        (
                        
                          ∑
                          
                            r
                            =
                            1
                          
                          
                            V
                          
                        
                        
                          n
                          
                            (
                            ⋅
                            )
                            ,
                            r
                          
                          
                            i
                            ,
                            −
                            (
                            m
                            ,
                            n
                            )
                          
                        
                        +
                        
                          β
                          
                            r
                          
                        
                        )
                      
                    
                  
                
                Γ
                
                  (
                  
                    n
                    
                      m
                      ,
                      (
                      ⋅
                      )
                    
                    
                      k
                      ,
                      −
                      (
                      m
                      ,
                      n
                      )
                    
                  
                  +
                  
                    α
                    
                      k
                    
                  
                  )
                
                
                  
                    
                      Γ
                      
                        (
                        
                          n
                          
                            (
                            ⋅
                            )
                            ,
                            v
                          
                          
                            k
                            ,
                            −
                            (
                            m
                            ,
                            n
                            )
                          
                        
                        +
                        
                          β
                          
                            v
                          
                        
                        )
                      
                    
                    
                      Γ
                      
                        (
                        
                          ∑
                          
                            r
                            =
                            1
                          
                          
                            V
                          
                        
                        
                          n
                          
                            (
                            ⋅
                            )
                            ,
                            r
                          
                          
                            k
                            ,
                            −
                            (
                            m
                            ,
                            n
                            )
                          
                        
                        +
                        
                          β
                          
                            r
                          
                        
                        )
                      
                    
                  
                
                
                  (
                  
                    n
                    
                      m
                      ,
                      (
                      ⋅
                      )
                    
                    
                      k
                      ,
                      −
                      (
                      m
                      ,
                      n
                      )
                    
                  
                  +
                  
                    α
                    
                      k
                    
                  
                  )
                
                
                  
                    
                      
                        n
                        
                          (
                          ⋅
                          )
                          ,
                          v
                        
                        
                          k
                          ,
                          −
                          (
                          m
                          ,
                          n
                          )
                        
                      
                      +
                      
                        β
                        
                          v
                        
                      
                    
                    
                      
                        ∑
                        
                          r
                          =
                          1
                        
                        
                          V
                        
                      
                      
                        n
                        
                          (
                          ⋅
                          )
                          ,
                          r
                        
                        
                          k
                          ,
                          −
                          (
                          m
                          ,
                          n
                          )
                        
                      
                      +
                      
                        β
                        
                          r
                        
                      
                    
                  
                
              
            
            
              
              
                
                =
                
                  ∏
                  
                    i
                  
                
                Γ
                
                  (
                  
                    n
                    
                      m
                      ,
                      (
                      ⋅
                      )
                    
                    
                      i
                      ,
                      −
                      (
                      m
                      ,
                      n
                      )
                    
                  
                  +
                  
                    α
                    
                      i
                    
                  
                  )
                
                
                  ∏
                  
                    i
                  
                
                
                  
                    
                      Γ
                      
                        (
                        
                          n
                          
                            (
                            ⋅
                            )
                            ,
                            v
                          
                          
                            i
                            ,
                            −
                            (
                            m
                            ,
                            n
                            )
                          
                        
                        +
                        
                          β
                          
                            v
                          
                        
                        )
                      
                    
                    
                      Γ
                      
                        (
                        
                          ∑
                          
                            r
                            =
                            1
                          
                          
                            V
                          
                        
                        
                          n
                          
                            (
                            ⋅
                            )
                            ,
                            r
                          
                          
                            i
                            ,
                            −
                            (
                            m
                            ,
                            n
                            )
                          
                        
                        +
                        
                          β
                          
                            r
                          
                        
                        )
                      
                    
                  
                
                
                  (
                  
                    n
                    
                      m
                      ,
                      (
                      ⋅
                      )
                    
                    
                      k
                      ,
                      −
                      (
                      m
                      ,
                      n
                      )
                    
                  
                  +
                  
                    α
                    
                      k
                    
                  
                  )
                
                
                  
                    
                      
                        n
                        
                          (
                          ⋅
                          )
                          ,
                          v
                        
                        
                          k
                          ,
                          −
                          (
                          m
                          ,
                          n
                          )
                        
                      
                      +
                      
                        β
                        
                          v
                        
                      
                    
                    
                      
                        ∑
                        
                          r
                          =
                          1
                        
                        
                          V
                        
                      
                      
                        n
                        
                          (
                          ⋅
                          )
                          ,
                          r
                        
                        
                          k
                          ,
                          −
                          (
                          m
                          ,
                          n
                          )
                        
                      
                      +
                      
                        β
                        
                          r
                        
                      
                    
                  
                
              
            
            
              
              
                
                ∝
                
                  (
                  
                    n
                    
                      m
                      ,
                      (
                      ⋅
                      )
                    
                    
                      k
                      ,
                      −
                      (
                      m
                      ,
                      n
                      )
                    
                  
                  +
                  
                    α
                    
                      k
                    
                  
                  )
                
                
                  
                    
                      
                        n
                        
                          (
                          ⋅
                          )
                          ,
                          v
                        
                        
                          k
                          ,
                          −
                          (
                          m
                          ,
                          n
                          )
                        
                      
                      +
                      
                        β
                        
                          v
                        
                      
                    
                    
                      
                        ∑
                        
                          r
                          =
                          1
                        
                        
                          V
                        
                      
                      
                        n
                        
                          (
                          ⋅
                          )
                          ,
                          r
                        
                        
                          k
                          ,
                          −
                          (
                          m
                          ,
                          n
                          )
                        
                      
                      +
                      
                        β
                        
                          r
                        
                      
                    
                  
                
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}&\propto \prod _{i\neq k}\Gamma \left(n_{m,(\cdot )}^{i,-(m,n)}+\alpha _{i}\right)\prod _{i\neq k}{\frac {\Gamma \left(n_{(\cdot ),v}^{i,-(m,n)}+\beta _{v}\right)}{\Gamma \left(\sum _{r=1}^{V}n_{(\cdot ),r}^{i,-(m,n)}+\beta _{r}\right)}}\Gamma \left(n_{m,(\cdot )}^{k,-(m,n)}+\alpha _{k}+1\right){\frac {\Gamma \left(n_{(\cdot ),v}^{k,-(m,n)}+\beta _{v}+1\right)}{\Gamma \left(\sum _{r=1}^{V}n_{(\cdot ),r}^{k,-(m,n)}+\beta _{r}+1\right)}}\\[8pt]&=\prod _{i\neq k}\Gamma \left(n_{m,(\cdot )}^{i,-(m,n)}+\alpha _{i}\right)\prod _{i\neq k}{\frac {\Gamma \left(n_{(\cdot ),v}^{i,-(m,n)}+\beta _{v}\right)}{\Gamma \left(\sum _{r=1}^{V}n_{(\cdot ),r}^{i,-(m,n)}+\beta _{r}\right)}}\Gamma \left(n_{m,(\cdot )}^{k,-(m,n)}+\alpha _{k}\right){\frac {\Gamma \left(n_{(\cdot ),v}^{k,-(m,n)}+\beta _{v}\right)}{\Gamma \left(\sum _{r=1}^{V}n_{(\cdot ),r}^{k,-(m,n)}+\beta _{r}\right)}}\left(n_{m,(\cdot )}^{k,-(m,n)}+\alpha _{k}\right){\frac {n_{(\cdot ),v}^{k,-(m,n)}+\beta _{v}}{\sum _{r=1}^{V}n_{(\cdot ),r}^{k,-(m,n)}+\beta _{r}}}\\[8pt]&=\prod _{i}\Gamma \left(n_{m,(\cdot )}^{i,-(m,n)}+\alpha _{i}\right)\prod _{i}{\frac {\Gamma \left(n_{(\cdot ),v}^{i,-(m,n)}+\beta _{v}\right)}{\Gamma \left(\sum _{r=1}^{V}n_{(\cdot ),r}^{i,-(m,n)}+\beta _{r}\right)}}\left(n_{m,(\cdot )}^{k,-(m,n)}+\alpha _{k}\right){\frac {n_{(\cdot ),v}^{k,-(m,n)}+\beta _{v}}{\sum _{r=1}^{V}n_{(\cdot ),r}^{k,-(m,n)}+\beta _{r}}}\\[8pt]&\propto \left(n_{m,(\cdot )}^{k,-(m,n)}+\alpha _{k}\right){\frac {n_{(\cdot ),v}^{k,-(m,n)}+\beta _{v}}{\sum _{r=1}^{V}n_{(\cdot ),r}^{k,-(m,n)}+\beta _{r}}}\end{aligned}}}
  
Note that the same formula is derived in the article on the Dirichlet-multinomial distribution, as part of a more general discussion of integrating Dirichlet distribution priors out of a Bayesian network.


== Faster sampling ==
Recent research has been focused on speeding up the inference of latent Dirichlet Allocation to support capture of a massive number of topics in large number of documents. The update equation of the collapsed Gibbs sampler mentioned in the earlier section has a natural sparsity within it that can be taken advantage of. Intuitively, since each document only contains a subset of topics 
  
    
      
        
          K
          
            d
          
        
      
    
    {\displaystyle K_{d}}
  , and a word also only appears in a subset of topics 
  
    
      
        
          K
          
            w
          
        
      
    
    {\displaystyle K_{w}}
  , the above update equation could be rewritten to take advantage of this sparsity.

  
    
      
        p
        (
        
          Z
          
            d
            ,
            n
          
        
        =
        k
        )
        ∝
        
          
            
              α
              β
            
            
              
                C
                
                  k
                
                
                  ¬
                  n
                
              
              +
              V
              β
            
          
        
        +
        
          
            
              
                C
                
                  k
                
                
                  d
                
              
              β
            
            
              
                C
                
                  k
                
                
                  ¬
                  n
                
              
              +
              V
              β
            
          
        
        +
        
          
            
              
                C
                
                  k
                
                
                  w
                
              
              (
              α
              +
              
                C
                
                  k
                
                
                  d
                
              
              )
            
            
              
                C
                
                  k
                
                
                  ¬
                  n
                
              
              +
              V
              β
            
          
        
      
    
    {\displaystyle p(Z_{d,n}=k)\propto {\frac {\alpha \beta }{C_{k}^{\neg n}+V\beta }}+{\frac {C_{k}^{d}\beta }{C_{k}^{\neg n}+V\beta }}+{\frac {C_{k}^{w}(\alpha +C_{k}^{d})}{C_{k}^{\neg n}+V\beta }}}
  
In this equation, we have three terms, out of which two of them are sparse, and the other is small. We call these terms 
  
    
      
        a
        ,
        b
      
    
    {\displaystyle a,b}
   and 
  
    
      
        c
      
    
    {\displaystyle c}
   respectively. Now, if we normalize each term by summing over all the topics, we get:

  
    
      
        A
        =
        
          ∑
          
            k
            =
            1
          
          
            K
          
        
        
          
            
              α
              β
            
            
              
                C
                
                  k
                
                
                  ¬
                  n
                
              
              +
              V
              β
            
          
        
      
    
    {\displaystyle A=\sum _{k=1}^{K}{\frac {\alpha \beta }{C_{k}^{\neg n}+V\beta }}}
  

  
    
      
        B
        =
        
          ∑
          
            k
            =
            1
          
          
            K
          
        
        
          
            
              
                C
                
                  k
                
                
                  d
                
              
              β
            
            
              
                C
                
                  k
                
                
                  ¬
                  n
                
              
              +
              V
              β
            
          
        
      
    
    {\displaystyle B=\sum _{k=1}^{K}{\frac {C_{k}^{d}\beta }{C_{k}^{\neg n}+V\beta }}}
  

  
    
      
        C
        =
        
          ∑
          
            k
            =
            1
          
          
            K
          
        
        
          
            
              
                C
                
                  k
                
                
                  w
                
              
              (
              α
              +
              
                C
                
                  k
                
                
                  d
                
              
              )
            
            
              
                C
                
                  k
                
                
                  ¬
                  n
                
              
              +
              V
              β
            
          
        
      
    
    {\displaystyle C=\sum _{k=1}^{K}{\frac {C_{k}^{w}(\alpha +C_{k}^{d})}{C_{k}^{\neg n}+V\beta }}}
  
Here, we can see that 
  
    
      
        B
      
    
    {\displaystyle B}
   is a summation of the topics that appear in document 
  
    
      
        d
      
    
    {\displaystyle d}
  , and 
  
    
      
        C
      
    
    {\displaystyle C}
   is also a sparse summation of the topics that a word 
  
    
      
        w
      
    
    {\displaystyle w}
   is assigned to across the whole corpus. 
  
    
      
        A
      
    
    {\displaystyle A}
   on the other hand, is dense but because of the small values of 
  
    
      
        α
      
    
    {\displaystyle \alpha }
   & 
  
    
      
        β
      
    
    {\displaystyle \beta }
  , the value is very small compared to the two other terms.
Now, while sampling a topic, if we sample a random variable uniformly from 
  
    
      
        s
        ∼
        U
        (
        s
        
          |
        
        ∣
        A
        +
        B
        +
        C
        )
      
    
    {\displaystyle s\sim U(s|\mid A+B+C)}
  , we can check which bucket our sample lands in. Since 
  
    
      
        A
      
    
    {\displaystyle A}
   is small, we are very unlikely to fall into this bucket; however, if we do fall into this bucket, sampling a topic takes O(K) time (same as the original Collapsed Gibbs Sampler). However, if we fall into the other two buckets, we only need to check a subset of topics if we keep a record of the sparse topics. A topic can be sampled from the 
  
    
      
        B
      
    
    {\displaystyle B}
   bucket in 
  
    
      
        O
        (
        
          K
          
            d
          
        
        )
      
    
    {\displaystyle O(K_{d})}
   time, and a topic can be sampled from the 
  
    
      
        C
      
    
    {\displaystyle C}
   bucket in 
  
    
      
        O
        (
        
          K
          
            w
          
        
        )
      
    
    {\displaystyle O(K_{w})}
   time where 
  
    
      
        
          K
          
            d
          
        
      
    
    {\displaystyle K_{d}}
   and 
  
    
      
        
          K
          
            w
          
        
      
    
    {\displaystyle K_{w}}
   denotes the number of topics assigned to the current document and current word type respectively.
Notice that after sampling each topic, updating these buckets are all basic 
  
    
      
        O
        (
        1
        )
      
    
    {\displaystyle O(1)}
   arithmetic operations.


== Applications, extensions and similar techniques ==
Topic modeling is a classic problem in information retrieval. Related models and techniques are, among others, latent semantic indexing, independent component analysis, probabilistic latent semantic indexing, non-negative matrix factorization, and Gamma-Poisson distribution.
The LDA model is highly modular and can therefore be easily extended. The main field of interest is modeling relations between topics. This is achieved by using another distribution on the simplex instead of the Dirichlet. The Correlated Topic Model follows this approach, inducing a correlation structure between topics by using the logistic normal distribution instead of the Dirichlet. Another extension is the hierarchical LDA (hLDA), where topics are joined together in a hierarchy by using the nested Chinese restaurant process. LDA can also be extended to a corpus in which a document includes two types of information (e.g., words and names), as in the LDA-dual model. Nonparametric extensions of LDA include the hierarchical Dirichlet process mixture model, which allows the number of topics to be unbounded and learnt from data and the nested Chinese restaurant process which allows topics to be arranged in a hierarchy whose structure is learnt from data.
As noted earlier, pLSA is similar to LDA. The LDA model is essentially the Bayesian version of pLSA model. The Bayesian formulation tends to perform better on small datasets because Bayesian methods can avoid overfitting the data. For very large datasets, the results of the two models tend to converge. One difference is that pLSA uses a variable 
  
    
      
        d
      
    
    {\displaystyle d}
   to represent a document in the training set. So in pLSA, when presented with a document the model hasn't seen before, we fix 
  
    
      
        Pr
        (
        w
        ∣
        z
        )
      
    
    {\displaystyle \Pr(w\mid z)}
  —the probability of words under topics—to be that learned from the training set and use the same EM algorithm to infer 
  
    
      
        Pr
        (
        z
        ∣
        d
        )
      
    
    {\displaystyle \Pr(z\mid d)}
  —the topic distribution under 
  
    
      
        d
      
    
    {\displaystyle d}
  . Blei argues that this step is cheating because you are essentially refitting the model to the new data.
Variations on LDA have been used to automatically put natural images into categories, such as "bedroom" or "forest", by treating an image as a document, and small patches of the image as words; one of the variations is called Spatial Latent Dirichlet Allocation.


== See also ==
Variational Bayesian methods
Pachinko allocation
tf-idf


== Notes ==


== External links ==
jLDADMM A Java package for topic modeling on normal or short texts. jLDADMM includes implementations of the LDA topic model and the one-topic-per-document Dirichlet Multinomial Mixture model. jLDADMM also provides an implementation for document clustering evaluation to compare topic models.
Extremely useful lecture for understanding LDA: LDA and Topic Modelling Video Lecture by David Blei or same lecture on YouTube
D. Mimno's LDA Bibliography An exhaustive list of LDA-related resources (incl. papers and some implementations)
Gensim, a Python+NumPy implementation of online LDA for inputs larger than the available RAM.
topicmodels and lda are two R packages for LDA analysis.
"Text Mining with R" including LDA methods, video presentation to the October 2011 meeting of the Los Angeles R users group
MALLET Open source Java-based package from the University of Massachusetts-Amherst for topic modeling with LDA, also has an independently developed GUI, the Topic Modeling Tool
LDA in Mahout implementation of LDA using MapReduce on the Hadoop platform
Latent Dirichlet Allocation (LDA) Tutorial for the Infer.NET Machine Computing Framework Microsoft Research C# Machine Learning Framework
LDA in Spark: Since version 1.3.0, Apache Spark also features an implementation of LDA
LDA, exampleLDA MATLAB implementation